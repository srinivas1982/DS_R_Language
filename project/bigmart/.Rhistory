data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
#ld_all = ld_all %>%
# mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
#                                                                   "OUT035")),
#         Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
#         Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
#  select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
#ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
#ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type,data = ld_train1)
library(car)
summary(fit)
vif(fit)
sort(vif(fit),decreasing = T)
setwd("C:\\Users\\30jag\\edvancer classes\\project\\bigmart")
train=read.csv("Train_Bigmart.csv",stringsAsFactors = F)
test = read.csv("Test_Bigmart.csv",stringsAsFactors = F)
View(train)
View(test)
names(train)
test$Item_Outlet_Sales=NA
train$data= "train"
test$data = "test"
ld_all = rbind(train,test)
View(ld_all)
unique(ld_all$Item_Identifier)
unique(ld_all$Item_Weight)
unique(ld_all$Item_Fat_Content)
sort(table(ld_all$Item_Fat_Content))
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for (cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
#ld_all = ld_all %>%
# mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
#                                                                   "OUT035")),
#         Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
#         Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
#  select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
#ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
#ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type
-Item_Fat_Content_LowFat,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type
-Item_Fat_Content_LowFat-Outlet_Establishment_Year,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type
-Item_Fat_Content_LowFat-Outlet_Establishment_Year-Item_Type_2,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type
-Item_Fat_Content_LowFat-Outlet_Establishment_Year-Item_Type_2
-Item_Fat_Content_Regular,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
prediction=predict(fit,newdata = ld_train2)
setwd("C:\\Users\\30jag\\edvancer classes\\project\\bigmart")
train=read.csv("Train_Bigmart.csv",stringsAsFactors = F)
test = read.csv("Test_Bigmart.csv",stringsAsFactors = F)
View(train)
View(test)
names(train)
test$Item_Outlet_Sales=NA
train$data= "train"
test$data = "test"
ld_all = rbind(train,test)
View(ld_all)
unique(ld_all$Item_Identifier)
unique(ld_all$Item_Weight)
unique(ld_all$Item_Fat_Content)
sort(table(ld_all$Item_Fat_Content))
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for (cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
#ld_all = ld_all %>%
# mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
#                                                                   "OUT035")),
#         Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
#         Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
#  select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP
-Outlet_Size-Outlet_Location_Type-Outlet_Identifier-Outlet_Location_Type
-Item_Fat_Content_LowFat-Outlet_Establishment_Year-Item_Type_2
-Item_Fat_Content_Regular,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
setwd("C:\\Users\\30jag\\edvancer classes\\project\\bigmart")
train=read.csv("Train_Bigmart.csv",stringsAsFactors = F)
test = read.csv("Test_Bigmart.csv",stringsAsFactors = F)
View(train)
View(test)
names(train)
test$Item_Outlet_Sales=NA
train$data= "train"
test$data = "test"
ld_all = rbind(train,test)
View(ld_all)
unique(ld_all$Item_Identifier)
unique(ld_all$Item_Weight)
unique(ld_all$Item_Fat_Content)
sort(table(ld_all$Item_Fat_Content))
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for (cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
#ld_all = ld_all %>%
# mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
#                                                                   "OUT035")),
#         Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
#         Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
#  select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP-Outlet_Identifier
,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
setwd("C:\\Users\\30jag\\edvancer classes\\project\\bigmart")
train=read.csv("Train_Bigmart.csv",stringsAsFactors = F)
test = read.csv("Test_Bigmart.csv",stringsAsFactors = F)
View(train)
View(test)
names(train)
test$Item_Outlet_Sales=NA
train$data= "train"
test$data = "test"
ld_all = rbind(train,test)
View(ld_all)
unique(ld_all$Item_Identifier)
unique(ld_all$Item_Weight)
unique(ld_all$Item_Fat_Content)
sort(table(ld_all$Item_Fat_Content))
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for (cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
#ld_all = ld_all %>%
# mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
#                                                                   "OUT035")),
#         Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
#         Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
#  select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
#ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP-Outlet_Identifier
-Outlet_Location_Type,data = ld_train1)
library(car)
summary(fit)
sort(vif(fit),decreasing = T)
setwd("C:\\Users\\30jag\\edvancer classes\\project\\bigmart")
train=read.csv("Train_Bigmart.csv",stringsAsFactors = F)
test = read.csv("Test_Bigmart.csv",stringsAsFactors = F)
View(train)
View(test)
names(train)
test$Item_Outlet_Sales=NA
train$data= "train"
test$data = "test"
ld_all = rbind(train,test)
View(ld_all)
unique(ld_all$Item_Identifier)
unique(ld_all$Item_Weight)
unique(ld_all$Item_Fat_Content)
sort(table(ld_all$Item_Fat_Content))
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for (cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
#ld_all = ld_all %>%
# mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
#                                                                   "OUT035")),
#         Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
#         Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
#  select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
#ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Identifier-Item_Weight-Item_Visibility-Item_MRP-Outlet_Identifier
-Outlet_Location_Type,data = ld_train1)
library(car)
sort(vif(fit),decreasing = T)
names(sort(vif(fit),decreasing = T))
View(sort(vif(fit),decreasing = T))
#ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
setwd("C:\\Users\\30jag\\edvancer classes\\project\\bigmart")
train=read.csv("Train_Bigmart.csv",stringsAsFactors = F)
test = read.csv("Test_Bigmart.csv",stringsAsFactors = F)
View(train)
View(test)
names(train)
test$Item_Outlet_Sales=NA
train$data= "train"
test$data = "test"
ld_all = rbind(train,test)
View(ld_all)
unique(ld_all$Item_Identifier)
unique(ld_all$Item_Weight)
unique(ld_all$Item_Fat_Content)
sort(table(ld_all$Item_Fat_Content))
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for (cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
lapply(ld_all, function(x) sum(is.na(x)))
ld_all = ld_all[!(is.na(ld_all$Item_Weight)),]
sort(table(ld_all$Item_Fat_Content))
ld_all= CreateDummies(ld_all,"Item_Fat_Content",400)
library(dplyr)
glimpse(ld_all)
sort(table(ld_all$Item_Type))
ld_all = ld_all %>%
mutate(Item_Type_1 = as.numeric(Item_Type %in% c("Fruits and Vegetables","Snack Foods","Household",
"Frozen Foods")),
Item_Type_2 = as.numeric(Item_Type %in% c("Dairy","Baking Goods","Canned"))) %>%
select(-Item_Type)
glimpse(ld_all)
sort(table(ld_all$Outlet_Identifier))
ld_all = ld_all %>%
mutate(Outlet_Identifier_1 = as.numeric(Outlet_Identifier %in% c("OUT049","OUT046",
"OUT035")),
Outlet_Identifier_2 = as.numeric(Outlet_Identifier %in% c("OUT013","OUT027")),
Outlet_Identifier_3 = as.numeric(Outlet_Identifier %in% c("OUT017","OUT018","OUT045"))) %>%
select(-Outlet_Identifier)
glimpse(ld_all)
sort(table(ld_all$Outlet_Size))
ld_all = CreateDummies(ld_all,"Outlet_Size",1500)
glimpse(ld_all)
sort(table(ld_all$Outlet_Location_Type))
ld_all = CreateDummies(ld_all,"Outlet_Location_Type",3000)
glimpse(ld_all)
sort(table(ld_all$Outlet_Type))
ld_all = CreateDummies(ld_all,"Outlet_Type",900)
glimpse(ld_all)
ld_all$Item_Identifier = NULL
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
sort(table(ld_all$Item_Weight))
sort(table(ld_all$Item_Visibility))
sort(table(ld_all$Item_MRP))
glimpse(ld_all)
sort(table(ld_all$Outlet_Establishment_Year))
ld_all$Outlet_Establishment_Year = NULL
glimpse(ld_all)
ld_train = ld_all %>% filter(data == "train") %>% select(-data)
ld_test  = ld_all %>% filter(data == "test") %>% select(-data,-Item_Outlet_Sales)
set.seed(2)
s = sample(1:nrow(ld_train),0.7*nrow(ld_train))
ld_train1 = ld_train[s,]
ld_train2 = ld_train[-s,]
fit = lm(Item_Outlet_Sales~.-Item_Weight-Item_Visibility-Item_MRP,data = ld_train1)
library(car)
View(sort(vif(fit),decreasing = T))
summary(fit)
