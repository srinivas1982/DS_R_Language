library(dplyr)
library(randomForest)
library(ggplot2)
library(tree)
library(cvTools)
setwd("/media/dell/D_PROJECTS/Edvancer_Class/Project2_R")
lg_train = read.csv("store_train.csv",stringsAsFactors = FALSE)
lg_test = read.csv("store_test.csv", stringsAsFactors = FALSE)
head(lg_test)
lg_train$data = "train"
lg_test$store = NA
lg_test$data = "test"
data = rbind(lg_train, lg_test)
glimpse(data)
View(data)
data$storecode = substr(data$storecode,1,5)
View(data)
View(data)
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for( cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
name=gsub("\\/","_",name)
name=gsub(">","GT_",name)
name=gsub("=","EQ_",name)
name=gsub(",","",name)
data[,name]=as.numeric(data[,var]==cat)
}
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for( cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
name=gsub("\\/","_",name)
name=gsub(">","GT_",name)
name=gsub("=","EQ_",name)
name=gsub(",","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
data = CreateDummies(data, "store_Type", 0)
data = CreateDummies(data, "state_alpha", 100)
data = CreateDummies(data, "storecode", 0)
null_values = lapply(data,function(x) sum(is.na(x)))
null_values[null_values > 0]
for(col in names(data)){
if(sum(is.na(data[,col]))>0 & !(col %in% c("data","store"))){
data[is.na(data[,col]),col]=mean(data[,col],na.rm=T)
}
}
data$store = as.factor(data$store)
rg_train=data %>% filter(data=='train') %>% select(-data)
rg_test=data %>% filter(data=='test') %>% select (-data,-store)
set.seed(2)
s=sample(1:nrow(rg_train),0.8*nrow(rg_train))
rg_train1=rg_train[s,]
rg_train2=rg_train[-s,]
rg.tree=tree(store~.-Id -countyname -Areaname -countytownname ,data=rg_train1)
val.score=predict(rg.tree,newdata = rg_train2,type='vector')[,2]
pROC::roc(rg_train2$store,val.score)$auc
CreateDummies=function(data,var,freq_cutoff=0){
t=table(data[,var])
t=t[t>freq_cutoff]
t=sort(t)
categories=names(t)[-1]
for( cat in categories){
name=paste(var,cat,sep="_")
name=gsub(" ","",name)
name=gsub("-","_",name)
name=gsub("\\?","Q",name)
name=gsub("<","LT_",name)
name=gsub("\\+","",name)
name=gsub("\\/","_",name)
name=gsub(">","GT_",name)
name=gsub("=","EQ_",name)
name=gsub(",","",name)
data[,name]=as.numeric(data[,var]==cat)
}
data[,var]=NULL
return(data)
}
library(dplyr)
library(randomForest)
library(ggplot2)
library(tree)
library(cvTools)
setwd("/media/dell/D_PROJECTS/Edvancer_Class/Project2_R")
source('/media/dell/D_PROJECTS/Edvancer_Class/Project2_R/retail.R')
